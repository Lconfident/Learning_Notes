## 1 简写

DB：数据库（Database）

DBMS：数据库管理系统（Database Management System）

SQL：结构化查询语言（Structured Query Language）

![image](https://ts1.cn.mm.bing.net/th/id/R-C.150a6722b6fa2ab6baf73557f5965dc3?rik=fM31sPaGdyO7Tg&riu=http%3a%2f%2fimg.sj33.cn%2fuploads%2fallimg%2f201402%2f7-14022H14522550.png&ehk=OAzVfmzjMhQO2Ukf5gAG8LmLom8ZCbHD29DdXR0UGX4%3d&risl=&pid=ImgRaw&r=0)

DBMS排名：

1. Oracle
2. MySQL
3. Microsoft SQL Server

>   关系型数据库管理系统（RDSMS）：
> 
>   二维表格形式（二元关系）
> 
>   行、列->表->数据库

## 2 命令

MySQL暂停服务命令：

`net stop mysql80`

开启命令：

`net start mysql80`

登录MySQL命令：

`mysql -u root -p `  + <kbd>Enter</kbd>

`输入root密码`(主机密码abc123)

查看MySQL版本命令：

`mysql -V`

退出MySQL：

```mysql
exit
或
quit
```

## 3认知

SQL（Structured Query Language,结构化查询语言）是使用关系模型的数据库应用语言，由IBM开发出来

**SQL的分类**

1. DDL（Data Definition Language、数据定义语言）：CREATE（创建） \ ALTER（修改） \ DROP（删除） \ RENAME（重命名） \ TRUECATE（清空）
2. DML（Data Manipuilation Language、数据操作语言）：INSERT（插入）\ DELETE（删除）\ UPDATE（更新）\ SELECT（选择）【增删改查】
3. DCL（Data Control Language、数据控制语言）：COMMIT（提交）\ ROLLBACK（撤销、回滚）\ SAVEPOINT（保存点）\ GRANT（授予）\ REVOKE（权限回收）

**SQL规则与规范**

规则：

- 字符串和日期时间用单引号表示，列的别名用双引号表示。
- 每条命令以`;或\g或\G`结束

规范：

- 数据库名、表名、表别名、字段名、字段别名都小写
- SQL关键字、函数名、绑定变量都大写

注释：

- 单行注释：`# 单行注释` （MySQL特有的注释）或者 `-- 注释文字`
- 多行注释：`/* xxx */`

**导入现有的数据**

- 命令行：source 文件的全路径名
- 基于图形化界面的工具导入

**Wins下SQL语句不区分大小写，Linux下严格区分大小写**

## 4 SELECT语句

```sql
# 选取所有employees中的字段
SELECT * FROM employees; 
# 选取指定字段
SELECT employee_id,last_name,salar FROM employees;
```

查询结果：结果集

**列的别名**

AS：alias，别名，可省略

列的别名可使用双引号,不要使用单引号

```sql
SELECT employee_id emp_id,last_name AS lname,department_id "dept_id"
FROM employees;
```

**去除重复行**

DISTINCT：不同的

**空值参与运算**

空值：null

null不等同于0

空值参与运算，结果也一定为空

引入IFNULL

```sql
SELECT employee_id,salary "月工资"，salary * (1+IFNULL(commission_pct,0) * 12 "年工资",commision_pct)
FROM employees;
```

 **着重号**

```sql
SELECT * FROM `order`;
```

**查询常数**

```sql
SELECT '硅谷',123,employee_id 
FROM employees;
```

**显示表结构**

describe：描述

```sql
DESCRIBE employees;
# 或者简写DESC
DESC employees;
```

**过滤数据**

where：哪里	声明在   `FROM `后面

```sql
SELECT * 
FROM employees
WHERE last_name = 'King';
```
## 5 运算符

```sql
SELECT 100 + 'a'	# 此时将'a'看作0处理
FROM DUAL;
SELECT 100 + 'NULL' # 空值参与运算结果为空（NULL）
FROM DUAL；
```

| 算术运算     | 运算符  |
| ------------ | ------- |
| 加           | +       |
| 减           | -       |
| 乘           | *       |
| 除           | /  DIV  |
| 求模（求余） | %   MOD |

| 比较运算符 |         解释         |
| :--------: | :------------------: |
|     =      |                      |
|    <=>     | 安全等于，为NULL而生 |
|  <>   !=   |        不等于        |

|   比较运算符    |           解释            |
| :-------------: | :-----------------------: |
|     IS NULL     |          是NULL           |
|     ISNULL      | ISNULL（commission_pact） |
|   IS NOT NULL   |         不是NULL          |
|    LEAST（）    |       least，最小的       |
|  GREATEST（）   |     greatest，最大的      |
| BETWEEN ... AND |    范围（包括边界值）     |
|       IN        |         in（set）         |
|     NOT IN      |        not in(set)        |
|      LIKE       |        模糊查询【`%`代表若干个不确定字符，`_` 代表一个不确定字符`\` 转义字符】        |
|REGEXP|regexp正则表达式|

| 逻辑运算符 |   作用   |
| :--------: | :------: |
| OR   `||`  |    或    |
| AND   `&&` |    且    |
| NOT    `!` |    非    |
|    XOR     | 逻辑异或 |

位运算符：	`& | ^ ~ >> <<`

按位与、按位或、按位异或、按位取反、按位左移、按位右移

## 6 排序和分页

默认情况下按照添加数据的顺序显示

ORDER BY

```sql
SELECT last_name,salary
FROM employees
ORDER BY salary;	#默认升序排列，从小到大

# 升序：ASC(ascend)
# 降序：DESC(descend)

```

列的别名只能在 ORDER BY 中使用，不能在 WHERE 中使用。

> 解释：首先从from开始查表，然后过滤数据，最后选出所需字段（别名才开始存在），条件**排序**（可以使用别名）

```sql
mysql> select last_name,salary as money
    -> from employees
    -> where money > 5000
    -> order by money desc;
ERROR 1054 (42S22): Unknown column 'money' in 'where clause'
```

**二级排序**

需求：显示员工信息，按照department_id降序排列，salary升序排列

```sql
SELECT employee_id,salary,department_id
FROM employees
ORDER BY department_id DESC,salary ASC;
```

**分页**

```sql
SELECT employee_id,last_name
FROM employees
LIMIT 0,20; # 显示第一页的20个字段，第一个参数为偏移量，第二个参数为记录条数
```

> 声明顺序
>
> SELECT
>
> FROM
>
> WHERE
>
> ORDER BY
>
> LIMIT

> MySQL8.0新特性：`LIMIT 2 OFFSET 31;`

## 7 多表查询

查一个东西，要不断地去查询子级字段。为了便利需要多表查询

```sql
# 错误实现：出现笛卡尔积错误
select employee_id,department_name
from employees,departments;# 2889 条记录
```

```sql
# 正确方式：需要有连接方式
SELECT
	employee_id,
	department_name
FROM
	employees,
	departments 
WHERE
	employees.department_id = departments.department_id;
```

**从sql优化的角度，建议每个字段前都指明其所在的表**

```sql
SELECT
	employees.employee_id,
	departments.department_name,
	employees.department_id
FROM
	employees,
	departments 
WHERE
	employees.department_id = departments.department_id;
```

**可以为表起个别名**，提高可读性

```sql
SELECT
	emp.employee_id,
	dept.department_name,
	emp.department_id
FROM
	employees emp,
	departments dept
WHERE
	emp.department_id = dept.department_id;
```

如果有n个表实现多表查询，则需要至少（n-1）个连接条件

## 8 多表查询的分类

1. 等值连接与非等值连接
2. 自连接与非自连接
3. 啊

```mysql
# 非等值连接
# 查询各个员工位于工资等级的梯度
SELECT
	e.last_name,
	e.salary,
	j.grade_level 
FROM
	employees e,
	job_grades j 
WHERE
	e.salary BETWEEN j.lowest_sal 
	AND j.highest_sal;
```

```mysql
# 自连接
# 查询员工id，员工名字和管理者id，管理者名字
SELECT
	e.employee_id,
	e.last_name,
	m.employee_id,
	m.last_name 
FROM
	employees AS e,
	employees AS m 
WHERE
	e.manager_id = m.employee_id;
```

```mysql
# 内连接：只包含匹配的行
# 外连接：另外包含不匹配的行，分为左外连接、右外连接、满外连接
# 不支持92标准语法，故用99标准语法
# SQL99语法实现内连接：
SELECT
	last_name,
	department_name,
	city 
FROM
	employees e
	INNER JOIN departments d ON e.department_id = d.department_id
	# inner 可省略
	JOIN locations l ON d.location_id = l.location_id;
	
	
# SQL99实现外连接
SELECT
last_name,
department_name,

FROM
	employees e
	LEFT JOIN departments d ON e.department_id = d.department_id;
	
SELECT
last_name,
department_name,

FROM
	employees e
	 JOIN departments d ON e.department_id = d.department_id;
# MySQL不支持满外FULL OUTER　JOIN　ON
```

**ＵＮＩＯＮ　和　ＵＮＩＯＮ　ALL操作**

-　UNION会执行去重操作
-　UINION　ALL不会执行去重操作

７种JOIN的实现****

**自然连接**`natural join `
自动查询等值字段，然后等值连接

**USING连接**`using（department_id）`
填入指定同名的字段

## 9单行函数

